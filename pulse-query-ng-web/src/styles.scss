/* 
 * Main Stylesheet. 
 * Implements Material Design 3 Styling via Angular Material. 
 * Overrides hardcoded palette colors with Runtime CSS Variables (--sys-*). 
 */ 

@use '@angular/material' as mat; 

// Base Material Core Styles 
@include mat.core(); 

// ------------------------------------------------------------------------- 
// 1. CORE VARIABLES (Defaults) 
// These CSS Variables are injected dynamically by ThemeService at runtime. 
// We define defaults here to prevent FOUC (Flash of Unstyled Content) 
// before hydration completes. 
// ------------------------------------------------------------------------- 
:root { 
  --sys-primary: #1565c0; 
  --sys-on-primary: #ffffff; 
  --sys-primary-container: #dce1ff; 
  --sys-on-primary-container: #00164d; 
  
  --sys-secondary: #585e71; 
  --sys-on-secondary: #ffffff; 
  --sys-secondary-container: #dce2f9; 
  --sys-on-secondary-container: #151b2c; 

  --sys-tertiary: #735471; 
  --sys-on-tertiary: #ffffff; 
  --sys-tertiary-container: #ffd7f9; 
  --sys-on-tertiary-container: #2b122b; 

  --sys-error: #ba1a1a; 
  --sys-on-error: #ffffff; 
  --sys-warn: #ffa000; 

  --sys-background: #fdfbff; 
  --sys-surface: #fdfbff; 
  --sys-on-surface: #1a1b1f; 
  
  --sys-on-background: #1a1b1f; 
  --sys-surface-variant: #e1e2ec; 
  --sys-on-surface-variant: #44474f; 
  --sys-surface-border: #e1e2ec; 
  --sys-outline: #757780; 
  --sys-outline-variant: #c4c7d0; 

  --sys-hover: rgba(26, 27, 31, 0.08); 
  --sys-selected: rgba(21, 101, 192, 0.12); 
  --sys-focus: rgba(26, 27, 31, 0.12); 
  
  --chart-color-1: #1565c0; 
  --chart-color-2: #585e71; 
  --chart-color-3: #735471; 
  --chart-neg: #ba1a1a; 
  
  --sys-autofill-bg: #ffffff; 
  --sys-autofill-text: #000000; 
} 

// ------------------------------------------------------------------------- 
// 2. ANGULAR MATERIAL THEME CONFIG 
// We define a standard M3 theme using strict Sass types. 
// Uses M3-specific palettes ($azure-palette) and strict M3 typography keys. 
// ------------------------------------------------------------------------- 

$m3-theme: mat.define-theme(( 
  color: ( 
    theme-type: light, 
    primary: mat.$azure-palette, 
    tertiary: mat.$violet-palette
  ), 
  typography: ( 
    brand-family: 'Roboto', 
    plain-family: 'Roboto', 
    bold-weight: 500, 
    medium-weight: 400, 
    regular-weight: 400 
  ), 
  density: ( 
    scale: 0 
  ) 
)); 

// Apply the theme to the root 
html { 
  @include mat.all-component-themes($m3-theme); 
  height: 100%; 
} 

// ------------------------------------------------------------------------- 
// 3. RUNTIME OVERRIDES 
// Angular Material writes its own CSS vars (e.g. --mat-sys-primary). 
// To make the components respect our Runtime `ThemeService`, we override 
// the Material System Tokens with our `--sys-*` variables. 
// ------------------------------------------------------------------------- 
body { 
  // Map Angular Material System Tokens -> Our Dynamic Runtime Tokens 
  --md-sys-color-primary: var(--sys-primary); 
  --md-sys-color-on-primary: var(--sys-on-primary); 
  --md-sys-color-primary-container: var(--sys-primary-container); 
  --md-sys-color-on-primary-container: var(--sys-on-primary-container); 

  --md-sys-color-secondary: var(--sys-secondary); 
  --md-sys-color-on-secondary: var(--sys-on-secondary); 
  --md-sys-color-secondary-container: var(--sys-secondary-container); 
  --md-sys-color-on-secondary-container: var(--sys-on-secondary-container); 

  --md-sys-color-tertiary: var(--sys-tertiary); 
  --md-sys-color-on-tertiary: var(--sys-on-tertiary); 
  --md-sys-color-tertiary-container: var(--sys-tertiary-container); 
  --md-sys-color-on-tertiary-container: var(--sys-on-tertiary-container); 

  --md-sys-color-error: var(--sys-error); 
  --md-sys-color-on-error: var(--sys-on-error); 
  
  --md-sys-color-background: var(--sys-background); 
  --md-sys-color-on-background: var(--sys-on-background); 
  
  --md-sys-color-surface: var(--sys-surface); 
  --md-sys-color-on-surface: var(--sys-on-surface); 
  --md-sys-color-surface-variant: var(--sys-surface-variant); 
  --md-sys-color-on-surface-variant: var(--sys-on-surface-variant); 
  
  --md-sys-color-outline: var(--sys-outline); 
  --md-sys-color-outline-variant: var(--sys-outline-variant); 

  // Base setup 
  margin: 0; 
  font-family: Roboto, "Helvetica Neue", sans-serif; 
  background-color: var(--sys-background); 
  color: var(--sys-on-background); 
  transition: background-color 0.3s ease, color 0.3s ease; 
} 

// ------------------------------------------------------------------------- 
// 4. DISPLAY MODES 
// ------------------------------------------------------------------------- 

body.mode-tv { 
  // TV Mode: Scale Typography using Material Tokens 
  font-size: 1.5rem; 
  
  // Hide Scrollbars 
  ::-webkit-scrollbar { width: 0; height: 0; } 
  
  // Enforce High Contrast Headers 
  .mat-headline-2, .mat-headline-1 { 
    font-size: 4rem !important; 
    font-weight: 700 !important; 
    letter-spacing: -0.02em; 
  } 
  
  // Enhance Card Titles 
  .mat-mdc-card-title { 
    font-size: 1.75rem !important; 
    line-height: normal !important; 
  } 
  
  // High Contrast Borders for Charts 
  .bar, .bar-segment { 
    stroke: var(--sys-background); 
    stroke-width: 2px; 
  } 
} 

// ------------------------------------------------------------------------- 
// 5. GLOBAL FORM CONTROLS 
// ------------------------------------------------------------------------- 
input, textarea, select { 
  background-color: transparent; 
  color: var(--sys-on-surface); 
  border-color: var(--sys-outline); 
  caret-color: var(--sys-primary); 
} 

// Fix for autofill background messing up Dark Mode 
input:-webkit-autofill, 
textarea:-webkit-autofill, 
select:-webkit-autofill { 
  -webkit-box-shadow: 0 0 0 1000px var(--sys-surface) inset !important; 
  -webkit-text-fill-color: var(--sys-on-surface) !important; 
}