@if (matrix(); as m) {
  <div
    class="heatmap-container"
    [style.grid-template-columns]="'auto repeat(' + m.xHeaders.length + ', 1fr)'"
    role="grid"
    aria-label="Heatmap Data Grid"
  >
    <!-- Top Left Corner (Empty) -->
    <div aria-hidden="true"></div>

    <!-- X Axis Header (Hours) -->
    @for (hx of m.xHeaders; track hx) {
      <div class="axis-label x-label" role="columnheader">{{ hx }}</div>
    }

    <!-- Rows -->
    @for (hy of m.yHeaders; track hy) {
      <!-- Y Axis Label (Service) -->
      <div class="axis-label y-label" [title]="hy" role="rowheader">{{ hy }}</div>

      <!-- Cells -->
      @for (hx of m.xHeaders; track hx) {
        <div
          class="cell"
          role="gridcell"
          [style.background-color]="getCellColor(m, hx, hy)"
          [matTooltip]="getCellTooltip(m, hx, hy)"
          [attr.aria-label]="getCellTooltip(m, hx, hy)"
        ></div>
      }
    }
  </div>

  <div class="legend" aria-hidden="true">
    <span>Low Load</span>
    <div class="legend-bar"></div>
    <span>High Load</span>
  </div>
} @else {
  <div class="flex items-center justify-center h-full text-gray-500">No Data</div>
}
